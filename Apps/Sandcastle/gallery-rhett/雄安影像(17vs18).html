<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
  />
  <title>雄安数据(17vs18)</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Widgets/widgets.css" rel="stylesheet">

</head>
<style>
  html, body{ margin:0; height:100%; }
  #cesiumContainer {
    width: 100%;
    height: 100%;
  }

  #slider {
    position: absolute;
    left: 50%;
    top: 0px;
    background-color: #d3d3d3;
    width: 5px;
    height: 100%;
    z-index: 9999;
  }

  #slider:hover {
    cursor: ew-resize;
  }
</style>
<body>
<div id="cesiumContainer">
  <div id="slider"></div>
</div>
<script>

  Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3ZTFhN2Y1OS1lYjUxLTRjZmYtODQxZi1mZTM4MDU4NWYwMWUiLCJpZCI6MTI5NDE3LCJpYXQiOjE2NzkyODg1ODJ9.XnmmLyiHnjdFa9BJZzCnz7f8zGZXh5RP_quL6nHd9Ts';

  // viewer 初始化
  const viewer = new Cesium.Viewer('cesiumContainer',
    {
      geocoder: true, //搜索框
      baseLayer: false,
      homeButton: false, //home按钮
      sceneModePicker: true, //3d/2d 模式切换按钮
      baseLayerPicker: false, //图层选择按钮
      navigationHelpButton: false, //右上角的帮助按钮
      animation: false, //左下角的动画控件的显示
      shouldAnimate: false, //控制模型动画
      timeline: false, //底部的时间轴
      fullscreenButton: false, //右下角的全屏按钮
      selectionIndicator: true, //选择指示器
      infoBox: true, //信息面板
    });

  viewer._cesiumWidget._creditContainer.style.display = "none"; //隐藏logo版权

  // 设置相机位置
  viewer.camera.setView({
    // 设置相机位置
    destination : Cesium.Cartesian3.fromDegrees(115.924598,39.045307, 15000.0),
  });

  const layers = viewer.imageryLayers;

  // 设置左侧图层
  const xiongAn17 = Cesium.ImageryLayer.fromProviderAsync(
    new Cesium.UrlTemplateImageryProvider({
      url : 'https://minio-api.csnd.com/rs-image/xiongan_0.5_0_18/{z}_{x}_{y}.png',
      maximumLevel: 17
    })
  );
  xiongAn17.splitDirection = Cesium.SplitDirection.LEFT;
  layers.add(xiongAn17);

  // 设置右侧图层
  const xiongAn18 = Cesium.ImageryLayer.fromProviderAsync(
    new Cesium.UrlTemplateImageryProvider({
      url : 'https://minio-api.csnd.com/rs-image/xiongan_0.5_0_18/{z}_{x}_{y}.png',
    })
  );
  xiongAn18.splitDirection = Cesium.SplitDirection.RIGHT;
  layers.add(xiongAn18);

  // 添加高德注记图层
  const gdLayer = Cesium.ImageryLayer.fromProviderAsync(
    new Cesium.UrlTemplateImageryProvider({
      url: 'http://webst02.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8',
      layer: 'tdtAnnoLayer',
      style: 'default',
      format: 'image/jpeg',
      tileMatrixSetID: 'GoogleMapsCompatible',
    })
  )

  layers.add(gdLayer);


  // The remaining code synchronizes the position of the slider with the split position
  const slider = document.getElementById("slider");
  viewer.scene.splitPosition =
    slider.offsetLeft / slider.parentElement.offsetWidth;

  const handler = new Cesium.ScreenSpaceEventHandler(slider);

  let moveActive = false;

  function move(movement) {
    if (!moveActive) {
      return;
    }

    const relativeOffset = movement.endPosition.x;
    const splitPosition =
      (slider.offsetLeft + relativeOffset) /
      slider.parentElement.offsetWidth;
    slider.style.left = `${100.0 * splitPosition}%`;
    viewer.scene.splitPosition = splitPosition;
  }

  handler.setInputAction(function () {
    moveActive = true;
  }, Cesium.ScreenSpaceEventType.LEFT_DOWN);
  handler.setInputAction(function () {
    moveActive = true;
  }, Cesium.ScreenSpaceEventType.PINCH_START);

  handler.setInputAction(move, Cesium.ScreenSpaceEventType.MOUSE_MOVE);
  handler.setInputAction(move, Cesium.ScreenSpaceEventType.PINCH_MOVE);

  handler.setInputAction(function () {
    moveActive = false;
  }, Cesium.ScreenSpaceEventType.LEFT_UP);
  handler.setInputAction(function () {
    moveActive = false;
  }, Cesium.ScreenSpaceEventType.PINCH_END);

</script>
</body>
</html>
